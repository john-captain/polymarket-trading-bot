# 风险评估与验收标准

> 本文档包含项目风险评估和各模块验收标准清单

---

## 一、风险评估

| 风险 | 可能性 | 影响 | 缓解措施 |
|------|--------|------|----------|
| **API 限速** | **高** | **高** | **统一限速控制 + 指数退避重试** |
| **API 日志过大** | **中** | **中** | **定期清理 + 响应数据截断** |
| 内存溢出 | 中 | 高 | 严格的队列容量限制 + 背压控制 |
| 下单失败 | 中 | 高 | 错误记录 + 不自动重试 |
| 数据不一致 | 低 | 中 | 事务处理 + 状态校验 |
| 策略冲突 | 低 | 中 | 同市场冷却时间 + 优先级控制 |
| 铸造失败 | 中 | 高 | 余额检查 + Gas 估算 + 错误记录 |

---

## 二、验收标准

### 2.1 API 请求层验收 ⭐

- [x] 所有第三方 API 调用通过统一客户端
- [x] 每次请求自动记录到 `api_request_logs` 表
- [x] 限速生效：Gamma 10/秒, CLOB 5/秒
- [x] 网络错误自动重试 (429/5xx)
- [x] 代理配置生效 (HTTP/SOCKS)
- [x] Settings 页面可查看 API 日志

### 2.2 市场列表页面验收 ⭐

- [ ] 页面正确展示数据库中的市场列表
- [ ] 搜索功能：按问题/ID 模糊搜索
- [ ] 筛选功能：状态/分类/标签筛选生效
- [ ] 高级筛选：交易量/流动性范围筛选生效
- [ ] 排序功能：交易量/流动性/时间排序正确
- [ ] 分页功能：每页100条，翻页正常
- [ ] 市场详情弹窗：展示完整信息
- [ ] 价格历史图表：正确展示 Yes/No 走势
- [ ] 外链跳转：正确打开 Polymarket 页面
- [ ] 已移除"开始同步"按钮

### 2.3 机会列表页面验收 ⭐

- [ ] 页面正确展示所有策略的机会
- [ ] 队列状态卡片：实时显示 4 个队列状态
- [ ] 筛选功能：按策略类型筛选 (MINT_SPLIT/ARBITRAGE/MARKET_MAKING)
- [ ] 筛选功能：按执行状态筛选 (PENDING/EXECUTING/SUCCESS/FAILED)
- [ ] 筛选功能：按时间范围筛选
- [ ] 搜索功能：按市场问题模糊搜索
- [ ] 分页功能：正确翻页
- [ ] 启动/停止按钮：正确控制队列系统
- [ ] 底部统计：正确显示今日发现/执行/成功/利润

### 2.4 机会详情弹窗验收 ⭐

- [ ] 正确显示策略类型和发现时间
- [ ] 正确显示市场问题和结果数
- [ ] 正确显示价格和、预期利润、投入金额
- [ ] 各结果详情表格：正确显示卖一价/量、计划/实际、状态
- [ ] 执行状态区：正确显示每一步执行时间和结果
- [ ] 失败时：正确显示错误信息
- [ ] 执行结果：正确显示实际利润和剩余持仓
- [ ] 关联记录：交易哈希可点击跳转

### 2.5 策略配置页面验收 ⭐

- [ ] 全局设置区：可配置自动执行、总资金、扫描间隔
- [ ] Mint-Split 卡片：可启用/禁用、显示运行状态和今日统计
- [ ] Mint-Split 配置：可修改价格和阈值、利润率、结果数、铸造金额、滑点、冷却时间
- [ ] Arbitrage 卡片：可启用/禁用、显示运行状态和今日统计
- [ ] Arbitrage 配置：可独立开关 LONG/SHORT、修改阈值、价差、金额
- [ ] Market-Making 卡片：可启用/禁用、显示运行状态和今日统计
- [ ] Market-Making 配置：可修改价差、金额、间隔、持仓上限、资金上限、偏斜阈值
- [ ] 保存功能：配置正确保存到数据库
- [ ] 热更新：配置修改后立即生效，无需重启
- [ ] 恢复默认：可恢复所有策略默认参数

### 2.6 功能验收

- [ ] 启动扫描后，数据自动存入 MySQL
- [ ] Mint-Split 策略检测到机会后自动铸造并卖出
- [ ] Arbitrage 策略检测到 LONG/SHORT 机会后自动下单
- [ ] Market-Making 策略自动挂单和刷新
- [ ] 机会列表页面正确显示所有机会
- [ ] 策略配置页面可以修改参数
- [ ] 队列状态实时更新
- [ ] 背压生效时扫描暂停

### 2.7 性能验收

- [ ] 扫描 1000 个市场 < 60 秒
- [ ] 内存占用 < 512MB
- [ ] 页面响应时间 < 500ms

### 2.8 稳定性验收

- [ ] 连续运行 24 小时无崩溃
- [ ] 错误正确记录到数据库
- [ ] 重启后可恢复状态

### 2.9 策略验收 ⭐

- [ ] Mint-Split: 价格和 > 1.005 时正确检测并执行
- [ ] Arbitrage LONG: 买价和 < 0.99 时正确检测并执行
- [ ] Arbitrage SHORT: 卖价和 > 1.01 时正确检测并执行
- [ ] Market-Making: 正确计算价差并挂单
- [ ] 交易执行队列按优先级处理订单
- [ ] 策略配置修改后立即生效

---

**上一章**: [06-tasks.md](./06-tasks.md) - 开发任务列表  
**返回索引**: [00-index.md](./00-index.md)
